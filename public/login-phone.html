<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒêƒÉng nh·∫≠p - Cown</title>
    <link rel="stylesheet" href="auth-phone.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <h1>Cown</h1>
                <p>ƒêƒÉng nh·∫≠p v√†o ·ª©ng d·ª•ng nh·∫Øn tin y√™u th√≠ch</p>
            </div>

            <div id="errorMessage" class="message error-message" style="display: none;"></div>
            <div id="successMessage" class="message success-message" style="display: none;"></div>

            <!-- Step 1: Phone Input -->
            <div id="phoneStep" class="auth-step active">
                <form id="phoneForm" class="auth-form">
                    <div class="step-info">
                        <div class="step-icon-modern">üì±</div>
                        <h3>Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i</h3>
                        <p>Ch√∫ng t√¥i s·∫Ω g·ª≠i m√£ x√°c th·ª±c ƒë·∫øn s·ªë ƒëi·ªán tho·∫°i c·ªßa b·∫°n</p>
                    </div>

                    <div class="form-group-modern">
                        <label for="phoneNumber" class="floating-label">S·ªë ƒëi·ªán tho·∫°i</label>
                        <div class="input-container-modern">
                            <div class="country-code-modern">
                                <select id="countryCode">
                                    <option value="+84">+84</option>
                                    <option value="+1">+1</option>
                                    <option value="+86">+86</option>
                                    <option value="+91">+91</option>
                                    <option value="+44">+44</option>
                                    <option value="+33">+33</option>
                                    <option value="+49">+49</option>
                                    <option value="+81">+81</option>
                                    <option value="+82">+82</option>
                                </select>
                            </div>
                            <input type="tel" id="phoneNumber" name="phoneNumber" 
                                   placeholder="912345678" required
                                   pattern="[0-9]{8,12}" class="modern-input">
                            <div class="input-icon-modern">
                                <i class="fas fa-phone"></i>
                            </div>
                        </div>
                        <small class="help-text-modern">
                            <i class="fas fa-info-circle"></i>
                            V√≠ d·ª•: 912345678 (kh√¥ng nh·∫≠p s·ªë 0 ƒë·∫ßu)
                        </small>
                    </div>

                    <button type="submit" class="submit-btn-modern" id="sendOtpBtn">
                        <span class="btn-content">
                            <span class="btn-icon">
                                <i class="fas fa-paper-plane"></i>
                            </span>
                            <span class="btn-text">G·ª≠i m√£ x√°c th·ª±c</span>
                            <span class="btn-ripple"></span>
                        </span>
                        <span class="btn-loading-modern" style="display: none;">
                            <div class="loading-spinner-modern"></div>
                            <span>ƒêang g·ª≠i...</span>
                        </span>
                    </button>

                    <div class="auth-info-mobile">
                        <p><i class="fas fa-shield-alt"></i> B·∫£o m·∫≠t v·ªõi MTProto</p>
                        <p><i class="fas fa-bolt"></i> K·∫øt n·ªëi tr·ª±c ti·∫øp Telegram</p>
                    </div>
                </form>
            </div>

            <!-- Step 2: OTP Verification -->
            <div id="otpStep" class="auth-step">
                <form id="otpForm" class="auth-form">
                    <div class="step-info">
                        <div class="step-icon-modern">üîê</div>
                        <h3>Nh·∫≠p m√£ x√°c th·ª±c</h3>
                        <p id="otpDescription">M√£ x√°c th·ª±c ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn s·ªë</p>
                        <div class="phone-display-modern" id="phoneDisplay"></div>
                    </div>

                    <div class="form-group-modern">
                        <label for="otpCode" class="floating-label">M√£ x√°c th·ª±c</label>
                        <div class="otp-input-container-modern">
                            <input type="text" id="otpCode" name="otpCode" 
                                   placeholder="000000" required
                                   pattern="[0-9]{6}" maxlength="6"
                                   autocomplete="one-time-code" class="modern-input otp-input">
                            <div class="input-icon-modern">
                                <i class="fas fa-key"></i>
                            </div>
                        </div>
                        <small class="help-text-modern">
                            <i class="fas fa-clock"></i>
                            M√£ c√≥ hi·ªáu l·ª±c trong <span id="otpTimer">5:00</span>
                        </small>
                    </div>

                    <button type="submit" class="submit-btn" id="verifyOtpBtn">
                        <span class="btn-text">
                            <i class="fas fa-check"></i>
                            X√°c th·ª±c
                        </span>
                        <span class="btn-loading" style="display: none;">
                            <div class="loading-spinner"></div>
                            ƒêang x√°c th·ª±c...
                        </span>
                    </button>

                    <div class="otp-actions">
                        <button type="button" class="btn-link" id="resendOtpBtn" disabled>
                            <i class="fas fa-redo"></i>
                            G·ª≠i l·∫°i m√£
                        </button>
                        <button type="button" class="btn-link" id="changePhoneBtn">
                            <i class="fas fa-edit"></i>
                            ƒê·ªïi s·ªë ƒëi·ªán tho·∫°i
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Right Side - Info -->
        <div class="auth-info">
            <div class="info-content">
                <div class="cow-mascot">
                    <div class="cow-face"></div>
                    <div class="cow-body">
                        <div class="cow-spots"></div>
                    </div>
                </div>
                
                <h2>Ch√†o m·ª´ng ƒë·∫øn v·ªõi Cown!</h2>
                <p>·ª®ng d·ª•ng nh·∫Øn tin Telegram v·ªõi giao di·ªán ƒë√°ng y√™u v√† hi·ªán ƒë·∫°i</p>
                
                <ul class="features-list">
                    <li>
                        <i class="fas fa-mobile-alt cow-icon"></i>
                        <span>ƒêƒÉng nh·∫≠p nhanh ch·ªâ v·ªõi s·ªë ƒëi·ªán tho·∫°i</span>
                    </li>
                    <li>
                        <i class="fas fa-shield-alt cow-icon"></i>
                        <span>B·∫£o m·∫≠t cao v·ªõi m√£ OTP</span>
                    </li>
                    <li>
                        <i class="fas fa-bolt cow-icon"></i>
                        <span>K·∫øt n·ªëi tr·ª±c ti·∫øp Telegram MTProto</span>
                    </li>
                    <li>
                        <i class="fas fa-comments cow-icon"></i>
                        <span>Giao di·ªán th√¢n thi·ªán, d·ªÖ s·ª≠ d·ª•ng</span>
                    </li>
                </ul>

                <div class="milk-animation">
                    <div class="milk-glass">ü•õ</div>
                    <div class="milk-flow"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="auth-phone.js"></script>
    <script>
        // Quick test function for debugging
        window.testOTP = async function(phone = '+84999111222') {
            console.log('üß™ Testing OTP with phone:', phone);
            try {
                const baseURL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' 
                    ? '' 
                    : 'https://cown-telegram-app.onrender.com';
                const response = await fetch(baseURL + '/api/auth/send-phone-otp', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ phone: phone }),
                    credentials: 'include'
                });
                const result = await response.json();
                console.log('üß™ Test result:', result);
                return result;
            } catch (error) {
                console.error('üß™ Test error:', error);
                return { error: error.message };
            }
        };
        console.log('üß™ Test function available: window.testOTP()');
    </script>
</body>
</html>
